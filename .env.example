# =============================================================================
# LOCAL DEVELOPMENT (no API keys)
# =============================================================================
# Copy this file to .env and uncomment the block below for local testing.
# Requires: ollama run llama3.2 (or another model)
#
# LLM_BACKEND=ollama
# OLLAMA_MODEL=llama3.2
# OLLAMA_MODEL=glm-4.7-flash
# OLLAMA_BASE_URL=http://localhost:11434
# GATEWAY_HOST=127.0.0.1
# GATEWAY_PORT=3000
#
# Then: cargo run
# Open: http://127.0.0.1:3000
# =============================================================================

# Database Configuration
DATABASE_URL=postgres://localhost/enclagent
DATABASE_POOL_SIZE=10

# LLM Provider (NEAR AI)
# NEAR AI provides a unified interface to all models with user authentication
# Session token is stored in ~/.enclagent/session.json and managed automatically.
# On first run, the agent will open a browser for OAuth authentication.
NEARAI_MODEL=claude-3-5-sonnet-20241022
NEARAI_BASE_URL=https://private.near.ai
NEARAI_AUTH_URL=https://private.near.ai
# NEARAI_SESSION_PATH=~/.enclagent/session.json  # optional, default shown

# Local LLM Providers (Ollama, LM Studio, vLLM, LiteLLM)
# LLM_BACKEND=nearai           # default
# Possible values: nearai, ollama, openai_compatible, openai, anthropic

# === Ollama ===
# OLLAMA_MODEL=llama3.2
# LLM_BACKEND=ollama
# OLLAMA_BASE_URL=http://localhost:11434   # default

# === OpenAI-compatible (LM Studio, vLLM, Anything-LLM) ===
# LLM_MODEL=llama-3.2-3b-instruct-q4_K_M
# LLM_BACKEND=openai_compatible
# LLM_BASE_URL=http://localhost:1234/v1
# LLM_API_KEY=sk-...                        # optional for local servers

# === OpenRouter (via OpenAI-compatible) ===
# LLM_MODEL=anthropic/claude-sonnet-4
# LLM_BACKEND=openai_compatible
# LLM_BASE_URL=https://openrouter.ai/api/v1
# LLM_API_KEY=sk-or-...

# === Anthropic-compatible (MiniMax via Anthropic API format) ===
# LLM_BACKEND=anthropic
# ANTHROPIC_MODEL=MiniMax-M2.5
# ANTHROPIC_BASE_URL=https://api.minimax.io/anthropic
# ANTHROPIC_API_KEY=...
# Supported MiniMax model IDs:
# - MiniMax-M2.5
# - MiniMax-M2.5-highspeed
# - MiniMax-M2.1
# - MiniMax-M2.1-highspeed
# - MiniMax-M2


# Channel Configuration
# CLI is always enabled

# Slack Bot (optional)
SLACK_BOT_TOKEN=xoxb-...
SLACK_APP_TOKEN=xapp-...
SLACK_SIGNING_SECRET=...

# Telegram Bot (optional)
TELEGRAM_BOT_TOKEN=...

# HTTP Webhook Server (optional)
HTTP_HOST=0.0.0.0
HTTP_PORT=8080
HTTP_WEBHOOK_SECRET=your-webhook-secret

# Frontdoor mode (user-facing wallet/session launcher for dedicated enclaves)
# Enable this on the shared "entry" deployment.
# GATEWAY_FRONTDOOR_ENABLED=true
# GATEWAY_FRONTDOOR_REQUIRE_PRIVY=true
# Launchpad is Privy-first. Keep REQUIRE_PRIVY enabled for staging/production parity.
# GATEWAY_FRONTDOOR_PRIVY_APP_ID=your_privy_app_id
# GATEWAY_FRONTDOOR_PRIVY_CLIENT_ID=your_privy_client_id
# Privy app/client fallback aliases are accepted for migration:
# FRONTDOOR_PRIVY_APP_ID / PRIVY_APP_ID / NEXT_PUBLIC_PRIVY_APP_ID
# FRONTDOOR_PRIVY_CLIENT_ID / PRIVY_CLIENT_ID / NEXT_PUBLIC_PRIVY_CLIENT_ID
# GATEWAY_FRONTDOOR_SESSION_TTL_SECS=900
# GATEWAY_FRONTDOOR_POLL_INTERVAL_MS=1500
# GATEWAY_FRONTDOOR_VERIFY_APP_BASE_URL=https://verify-sepolia.eigencloud.xyz/app
#
# Provisioner command contract:
# - Must output an instance URL to stdout.
# - Plain URL output is supported.
# - JSON output may include:
#   `instance_url` / `url` / `gateway_url` (required unless plain URL output)
#   `verify_url` or `app_id`/`eigen_app_id` for verify portal linking.
# - Placeholders available:
#   {session_id} {wallet_address} {privy_user_id} {chain_id} {version}
#   {privy_identity_token} {privy_access_token}
#   {profile_name} {custody_mode}
#   {operator_wallet_address} {user_wallet_address} {vault_address}
#   {gateway_auth_key} {eigencloud_auth_key}
#   {verification_backend} {verification_eigencloud_endpoint}
#   {verification_eigencloud_auth_scheme} {verification_eigencloud_timeout_ms}
#   {verification_fallback_enabled} {verification_fallback_signing_key_id}
#   {verification_fallback_chain_path} {verification_fallback_require_signed_receipts}
#   {verify_app_base_url} {config_json} {config_b64}
#
# Example:
# GATEWAY_FRONTDOOR_PROVISION_COMMAND=/app/scripts/provision-user-ecloud.sh --wallet '{wallet_address}' --session '{session_id}' --config '{config_b64}'
#
# Provisioner script options (if using /app/scripts/provision-user-ecloud.sh):
# ECLOUD_FRONTDOOR_IMAGE_REF=docker.io/your-org/enclagent:latest
# ECLOUD_FRONTDOOR_ENV_FILE=/app/deploy/ecloud-instance.env
# ECLOUD_FRONTDOOR_INSTANCE_TYPE=g1-standard-4t
# ECLOUD_FRONTDOOR_INSTANCE_PORT=3000
#
# Fallback (no per-user provisioning, single shared instance):
# GATEWAY_FRONTDOOR_DEFAULT_INSTANCE_URL=https://verify-sepolia.eigencloud.xyz/app/<app-id>

# Bridge service (required for /funding and mutating /vault command actions)
# ENCLAGENT_BRIDGE_URL=http://localhost:3000
# ENCLAGENT_BRIDGE_API_KEY=your_bridge_api_key
# Optional aliases supported by Enclagent runtime:
# ENCLAGENT_BRIDGE_BASE_URL=http://localhost:3000
# HYPERLIQUID_BRIDGE_URL=http://localhost:3000
# HYPERLIQUID_BRIDGE_BASE_URL=http://localhost:3000
# HYPERLIQUID_BRIDGE_API_KEY=your_bridge_api_key
# MCP_API_KEY=your_bridge_api_key

# ROMA sidecar integration (design contract; adapter not wired by default)
# ROMA_API_ENABLED=false
# ROMA_API_BASE_URL=http://127.0.0.1:8000
# ROMA_API_KEY=
# ROMA_DEFAULT_PROFILE=general
# ROMA_DEFAULT_MAX_DEPTH=2
# ROMA_POLL_INTERVAL_MS=2000
# ROMA_REQUEST_TIMEOUT_MS=30000

# Agent Settings
AGENT_NAME=enclagent
AGENT_MAX_PARALLEL_JOBS=5
AGENT_JOB_TIMEOUT_SECS=3600
AGENT_STUCK_THRESHOLD_SECS=300
# Max LLM tool-call loop iterations per turn (default: 30, max: 200)
# AGENT_MAX_TOOL_ITERATIONS=30
# Enable planning phase before tool execution (default: true)
AGENT_USE_PLANNING=true

# Self-repair settings
SELF_REPAIR_CHECK_INTERVAL_SECS=60
SELF_REPAIR_MAX_ATTEMPTS=3

# Heartbeat settings (proactive periodic execution)
# When enabled, reads HEARTBEAT.md checklist and reports findings
HEARTBEAT_ENABLED=false
HEARTBEAT_INTERVAL_SECS=1800
HEARTBEAT_NOTIFY_CHANNEL=cli
HEARTBEAT_NOTIFY_USER=default

# Safety settings
SAFETY_MAX_OUTPUT_LENGTH=100000
SAFETY_INJECTION_CHECK_ENABLED=true

# Logging
RUST_LOG=enclagent=debug,tower_http=debug
