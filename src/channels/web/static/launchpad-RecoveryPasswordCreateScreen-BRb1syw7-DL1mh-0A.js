import{r as a,j as A}from"./launchpad.js";import{d4 as T,d5 as M,dR as W,dy as R,d6 as j,dJ as L,dS as S}from"./launchpad-App-D179iYht.js";import{u as $,o as D}from"./launchpad-SetWalletPasswordForm-C2hZtfwu-CbQ0-1k2.js";import"./launchpad-ExclamationTriangleIcon-DS9jnCFw.js";import"./launchpad-Layouts-BlFm53ED-HTJjrY9f.js";import"./launchpad-ModalHeader-JjfRejxC-gvXxgADS.js";import"./launchpad-shared-BcHk2XA3-Dl2lUF-0.js";import"./launchpad-Checkbox-BhNoOKjX-B_tAnTk6.js";import"./launchpad-CheckCircleIcon-BvqP64EM.js";import"./launchpad-ScreenHeader-CHmc4-Lu-Bz0hvEfr.js";const X={component:()=>{let{navigate:d,data:v,onUserCloseViaDialogOrKeybindRef:C}=T(),g=M(),[x,P]=a.useState(""),[u,c]=a.useState(!1),[s,h]=a.useState(),[n,b]=a.useState(null),{create:r}=W(),{authenticated:m,user:o}=R(),{closePrivyModal:l,isNewUserThisSession:E,initializeWalletProxy:U}=j(),{onSuccess:w,onFailure:i,callAuthOnSuccessOnClose:p,shouldCreateEth:f,shouldCreateSol:y}=v.createWallet,[t,I]=a.useState(null),O=new L(async()=>{try{let e;if(f&&y)e=await r({recoveryMethod:"user-passcode",recoveryPassword:s,chainType:"ethereum",walletIndex:0,latestUser:o}),e=await r({chainType:"solana",walletIndex:0,latestUser:e.user});else if(y)e=await r({recoveryMethod:"user-passcode",recoveryPassword:s,chainType:"solana",walletIndex:0,latestUser:o});else{if(!f)throw Error("Invalid args to create wallet");e=await r({recoveryMethod:"user-passcode",recoveryPassword:s,chainType:"ethereum",walletIndex:0,latestUser:o})}I(e),E?d("EmbeddedWalletCreatedScreen"):(w(e),l({shouldCallAuthOnSuccess:p}))}catch(e){P(e.message)}});return a.useEffect(()=>{n||U(3e4).then(e=>b(e))},[n]),a.useEffect(()=>{if(!m||!o)return d("LandingScreen"),void i(Error("User must be authenticated before creating a Privy wallet"))},[m]),C.current=()=>null,A.jsx($,{config:{initiatedBy:"automatic"},appName:g?.name||"privy",loading:!n,buttonLoading:u,buttonHideAnimations:!t&&u,isResettingPassword:!1,error:x,password:s||"",onClose:()=>{t&&t.account.recoveryMethod!=="user-passcode"?(i(new S("User created a wallet but failed to set a password for it")),l({shouldCallAuthOnSuccess:!1})):t?(w(t),l({shouldCallAuthOnSuccess:p})):(i(new S("User wallet creation failed")),l({shouldCallAuthOnSuccess:!1}))},onPasswordChange:h,onPasswordGenerate:()=>h(D()),onSubmit:async()=>(c(!0),O.execute().then(()=>new Promise(e=>setTimeout(e,250))).finally(()=>c(!1)))})}};export{X as EmbeddedWalletPasswordCreateScreen,X as default};
