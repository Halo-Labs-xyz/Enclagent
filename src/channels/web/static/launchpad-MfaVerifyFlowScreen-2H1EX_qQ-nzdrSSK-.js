import{r,j as f}from"./launchpad.js";import{dy as M,d5 as B,eD as E}from"./launchpad-App-D179iYht.js";import{K as j,R as C,q as A,X as g}from"./launchpad-to-ui-error-CmP4i4IC-CtfAtO2K.js";import"./launchpad-PinInput-3SLvbnQa-CovKtgDb.js";import"./launchpad-FingerPrintIcon-CpCeQsPn.js";import"./launchpad-PhoneIcon-C1ddPHdQ.js";import"./launchpad-ShieldCheckIcon-CP_2fGKU.js";import"./launchpad-ModalHeader-JjfRejxC-gvXxgADS.js";import"./launchpad-ScreenLayout-Ca6ml9wY-CeAdm0Km.js";import"./launchpad-Screen-DE3ldE_X-BBf8NvvX.js";import"./launchpad-index-Dq_xe9dz-bxbF5Mdc.js";import"./launchpad-ExclamationTriangleIcon-DS9jnCFw.js";import"./launchpad-StackedContainer-B2vaEl56-DAGpnjTg.js";import"./launchpad-useGetTokenPrice-PWP-Uiot-DSryU3xF.js";import"./launchpad-useGetSolPrice-DwwjjGbd-C6EP3HJh.js";import"./launchpad-TransactionDetails-DkPozym_-DJ9OmnKi.js";import"./launchpad-WalletLink-B12jNftF-DRQ54pOI.js";import"./launchpad-ethers-VWEScvge-ty8Zt0i3.js";import"./launchpad-getFormattedUsdFromLamports-B6EqSEho-C-HCdwKa.js";import"./launchpad-transaction-CnfuREWo-BX0tihxo.js";import"./launchpad-Layouts-BlFm53ED-HTJjrY9f.js";import"./launchpad-ChevronDownIcon-D09uGFR6.js";const Z=({onClose:n})=>{let{user:l}=M(),p=B(),a=r.useMemo(()=>l?.mfaMethods.filter(e=>e!=="passkey"||!p.globalDisablePasskeys)??[],[l?.mfaMethods,p.globalDisablePasskeys]),[o,i]=r.useState(a[0]??null),{init:d,cancel:w,submit:h}=E(),[y,k]=r.useState(!1),[v,x]=r.useState(null),[c,s]=r.useState();r.useEffect(()=>{i(a[0]??null)},[a]);let u=r.useRef(!1);async function S(e){s(void 0);try{if(!e||!o)return;await h(o,e),k(!0),s(void 0),n()}catch(t){throw g(t).error}}async function b(e){if(e!=="passkey")try{i(e),await d(e)}catch(t){console.error(t)}else try{i(e);let t=await d(e);if(!t)throw Error("something went wrong");x(t),await h(e,t),k(!0),s(void 0),n()}catch(t){s(g(t))}}r.useEffect(()=>{!u.current&&o&&(u.current=!0,b(o).finally(()=>{u.current=!1}))},[]);let m=()=>{i(null),s(void 0),w(),n()};return l?o==="passkey"?f.jsx(j,{account:l.linkedAccounts.filter(e=>e.type==="passkey"&&e.enrolledInMfa).sort((e,t)=>t.firstVerifiedAt.valueOf()-e.firstVerifiedAt.valueOf())[0],submitSuccess:y,hasBlockingError:c?.isBlocking??!1,error:c?.error,onClose:m,onBack:()=>{i(null),s(void 0)},handleSubmit:()=>S(v).catch(s)}):o?f.jsx(C,{submitSuccess:y,hasBlockingError:c?.isBlocking??!1,handleSubmitCode:S,selectedMethod:o,onClose:m,onBack:a.length>1?()=>i(null):void 0}):f.jsx(A,{mfaMethods:a,onSelect:b,handleClose:m}):null};export{Z as MfaVerifyFlowScreen,Z as default};
