import{r as t,j as p}from"./launchpad.js";import{d4 as P,d5 as C,d6 as _,dy as b,du as m,d8 as O,d9 as g,dq as T}from"./launchpad-App-D179iYht.js";import{a as W}from"./launchpad-shouldProceedtoEmbeddedWalletCreationFlow-BsPl2jCD-BqPojStS.js";import{n as x}from"./launchpad-ScreenLayout-Ca6ml9wY-CeAdm0Km.js";import{F as j}from"./launchpad-fingerprint-pattern-eZF4302v.js";import"./launchpad-ModalHeader-JjfRejxC-gvXxgADS.js";import"./launchpad-Screen-DE3ldE_X-BBf8NvvX.js";import"./launchpad-index-Dq_xe9dz-bxbF5Mdc.js";import"./launchpad-createLucideIcon-BSOjrqRH.js";const F=({status:e,passkeySignupFlow:i=!1,error:s,onRetry:a})=>p.jsx(x,{title:(()=>{switch(e){case"loading":return"Waiting for passkey";case"success":return"Success";case"error":return"Something went wrong"}})(),subtitle:p.jsx(R,{children:(()=>{switch(e){case"loading":return i?"Please follow prompts to register your passkey.":`Please follow prompts to verify your passkey.
You will have to sign up with another method first to register a passkey for your account.`;case"success":return"You've successfully logged in with your passkey.";case"error":if(s instanceof O){if(s.privyErrorCode===g.CANNOT_LINK_MORE_OF_TYPE)return"Cannot link more passkeys to account.";if(s.privyErrorCode===g.PASSKEY_NOT_ALLOWED)return`Passkey request timed out or rejected by user.
You will have to sign up with another method first to register a passkey for your account.`}return`An unknown error occurred.
You will have to sign up with another method first to register a passkey for your account.`}})()}),icon:j,iconVariant:"loading",iconLoadingStatus:{success:e==="success",fail:e==="error"},primaryCta:e==="error"&&a?{label:"Retry",onClick:a}:e==="success"?{label:"Continue",disabled:!0}:void 0,watermark:!0}),$={component:()=>{let{data:e,setModalData:i,navigate:s}=P(),a=C(),{loginWithPasskey:h,signupWithPasskey:w,closePrivyModal:k,createAnalyticsEvent:S}=_(),{user:o,logout:v}=b(),{passkeySignupFlow:d}=e?.passkeyAuthModalData??{},y=m-500,[u,c]=t.useState("loading"),[E,A]=t.useState(null),n=t.useRef([]),l=r=>{n.current=[r,...n.current]};t.useEffect(()=>()=>{n.current.forEach(r=>clearTimeout(r)),n.current=[]},[]);let f=async()=>{c("loading");try{d?await w():await h(),c("success")}catch(r){A(r),c("error")}};return t.useEffect(()=>{if(u==="success"&&o){if(a?.legal.requireUsersAcceptTerms&&!o.hasAcceptedTerms)return void l(setTimeout(()=>{s("AffirmativeConsentScreen")},y));if(!W(o,a?.embeddedWallets))return void l(setTimeout(()=>{k({shouldCallAuthOnSuccess:!0,isSuccess:!0})},m));l(setTimeout(()=>{i({createWallet:{onSuccess:()=>{},onFailure:r=>{console.error(r),S({eventName:"embedded_wallet_creation_failure_logout",payload:{error:r,screen:"PasskeyStatusScreen"}}),v()},callAuthOnSuccessOnClose:!0}}),s("EmbeddedWalletOnAccountCreateScreen")},y))}},[o,u]),t.useEffect(()=>{f()},[]),p.jsx(F,{status:u,passkeySignupFlow:d,error:E,onRetry:f})}};let R=T.span`
  white-space: pre-wrap;
`;export{$ as PasskeyStatusScreen,F as PasskeyStatusScreenView,$ as default};
