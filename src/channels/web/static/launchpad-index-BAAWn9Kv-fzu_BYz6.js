import{r as a,j as s}from"./launchpad.js";import{d as ye}from"./launchpad-Address-D-q_5it9-DVYLY2Ks.js";import{d4 as Ze,d6 as J,dy as et,d5 as tt,dE as he,c as nt,h as at,eq as st,er as it,de as rt,bS as ot,du as lt,es as ge,et as Ie,eu as ut,ev as pt,by as dt,bv as ct,cU as mt,dq as ve}from"./launchpad-App-D179iYht.js";import{c as yt}from"./launchpad-useGetTokenPrice-PWP-Uiot-DSryU3xF.js";import{s as ft}from"./launchpad-useWalletBalance-CDyi5_iR-DCkRGcPf.js";import{n as bt}from"./launchpad-getErc20TokenInfo-1Q6w1Ibq-Dxg0lWgJ.js";import{t as Tt}from"./launchpad-formatErc20TokenAmount-BuPk9xcy-CkAr4Oc0.js";import{c as fe,o as K,i as ht}from"./launchpad-ethers-VWEScvge-ty8Zt0i3.js";import{ErrorScreenView as gt}from"./launchpad-ErrorScreen-V8ec2dKP-DjcwwqNu.js";import{T as ke,u as xe,m as It}from"./launchpad-ModalHeader-JjfRejxC-gvXxgADS.js";import{a as vt}from"./launchpad-JsonTree-aPaJmPx7-Dog5uYEJ.js";import{n as kt,Q as xt}from"./launchpad-TransactionErrorView-f1bQRoCZ-CkSFCgYG.js";import{s as Et}from"./launchpad-Layouts-BlFm53ED-HTJjrY9f.js";import{n as Mt}from"./launchpad-ScreenHeader-CHmc4-Lu-Bz0hvEfr.js";import{$ as St}from"./launchpad-TransactionDetails-DkPozym_-DJ9OmnKi.js";import{t as Ft}from"./launchpad-transfer-6YztDh-t-DU6hH7CZ.js";import{i as _t}from"./launchpad-formatters-_15u2lww.js";import"./launchpad-check-C5kCRahI.js";import"./launchpad-createLucideIcon-BSOjrqRH.js";import"./launchpad-copy-DYa4Op8P.js";import"./launchpad-useGetSolPrice-DwwjjGbd-C6EP3HJh.js";import"./launchpad-reservoir-0wfhnc0j-DglEJspj.js";import"./launchpad-ScreenLayout-Ca6ml9wY-CeAdm0Km.js";import"./launchpad-Screen-DE3ldE_X-BBf8NvvX.js";import"./launchpad-index-Dq_xe9dz-bxbF5Mdc.js";import"./launchpad-lock-DOKCRgid.js";import"./launchpad-Value-tcJV9e0L-rc9R0DBN.js";import"./launchpad-LoadingSkeleton-U6-3yFwI-De_7LaVb.js";import"./launchpad-ErrorMessage-D8VaAP5m-xTbV0e-V.js";import"./launchpad-LabelXs-oqZNqbm_-D2WTgiPX.js";import"./launchpad-Subtitle-CV-2yKE4-xZAXWUw0.js";import"./launchpad-Title-BnzYV3Is-Bc_Ic5pg.js";import"./launchpad-WalletInfoCard-CuZCmvHw-BQqSNujJ.js";import"./launchpad-shared-FM0rljBt-BThDrsH1.js";import"./launchpad-Checkbox-BhNoOKjX-B_tAnTk6.js";import"./launchpad-ErrorBanner-CQERa7bL-D9Jz_y-z.js";import"./launchpad-ExclamationCircleIcon-DuVuT9M1.js";import"./launchpad-WarningBanner-c8L53pJ2-Bp2I71hA.js";import"./launchpad-ExclamationTriangleIcon-DS9jnCFw.js";import"./launchpad-ChevronDownIcon-D09uGFR6.js";import"./launchpad-WalletLink-B12jNftF-DRQ54pOI.js";import"./launchpad-getFormattedUsdFromLamports-B6EqSEho-C-HCdwKa.js";import"./launchpad-transaction-CnfuREWo-BX0tihxo.js";let Ct=[{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}],Nt=ve.div`
  display: flex;
  flex-direction: column;
  min-height: 72px;
`;var wt=({onBack:e,details:r})=>s.jsxs(Nt,{children:[s.jsx(ke,{backFn:e}),s.jsx(vt,{data:r}),s.jsx(xe,{})]});let $t=({gasUsed:e,effectiveGasPrice:r})=>{if(e&&r)try{return mt(e*r)}catch{return}};const At=({txn:e,receipt:r,transactionInfo:p,onClose:d,tokenPrice:t,tokenSymbol:i,receiptHeader:y,receiptDescription:g})=>s.jsxs(s.Fragment,{children:[s.jsx(ke,{onClose:d}),s.jsx(Mt,{title:y??"Transaction complete!",description:g??"You're all set."}),s.jsx(St,{tokenPrice:t,from:r.from,to:r.to,gas:$t(r),txn:e,transactionInfo:p,tokenSymbol:i}),s.jsx(pt,{}),s.jsx(jt,{loading:!1,onClick:d,children:"All Done"}),s.jsx(Et,{}),s.jsx(xe,{})]});let jt=ve(It)`
  && {
    margin-top: 24px;
  }
  transition:
    color 350ms ease,
    background-color 350ms ease;
`;const Ot=[{constant:!1,inputs:[{name:"_salt",type:"bytes32"},{name:"_initializer",type:"bytes"}],name:"deployAccount",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],Rt=[{name:"from",type:"address"},{name:"param2",type:"address"},{name:"param3",type:"bytes"},{name:"param4",type:"tuple",components:[]},{type:"tuple",components:[{name:"param5",type:"address"},{name:"param6",type:"uint256"},{name:"param7",type:"uint256"},{name:"encodedInitData",type:"bytes"}]}],Dt=[{constant:!1,inputs:[{name:"spender",type:"address"},{name:"value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],Bt=[{inputs:[{name:"to",type:"address"},{name:"amount",type:"uint256"},{name:"memo",type:"bytes32"}],name:"transferWithMemo",outputs:[{name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"}],qt=[{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"mint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"mint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"}],name:"mint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"}],name:"mint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"quantity",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"quantity",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256[]",name:"tokenIds",type:"uint256[]"},{internalType:"uint256[]",name:"quantities",type:"uint256[]"},{internalType:"bytes",name:"data",type:"bytes"}],name:"mintBatch",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256[]",name:"tokenIds",type:"uint256[]"},{internalType:"uint256[]",name:"quantities",type:"uint256[]"},{internalType:"bytes",name:"data",type:"bytes"}],name:"mintBatch",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"quantity",type:"uint256"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"quantity",type:"uint256"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"}],name:"safeMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"}],name:"safeMint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"string",name:"uri",type:"string"}],name:"safeMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"string",name:"uri",type:"string"}],name:"safeMint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeMint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"uri",type:"string"}],name:"safeMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"uri",type:"string"}],name:"safeMint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"batchMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"batchMint",outputs:[],stateMutability:"payable",type:"function"}],Pt=[{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],Ut=[{constant:!1,inputs:[{name:"_operator",type:"address"},{name:"_approved",type:"bool"}],name:"setApprovalForAll",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],Ht=[{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_tokenId",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],Lt=[{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_tokenIds",type:"uint256[]"},{name:"_amounts",type:"uint256[]"},{name:"_data",type:"bytes"}],name:"safeBatchTransferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],Vt=[{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_tokenId",type:"uint256"},{name:"_amount",type:"uint256"},{name:"_data",type:"bytes"}],name:"safeTransferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],Ee=(e,r)=>{let p=k(Dt,e);if(p)return{action:"approve",functionName:"approve",isErc20Ish:!0,isNFTIsh:!1,spender:p.args[0],amount:p.args[1]};let d=k(Ft,e);if(d)return{action:"transfer",functionName:"transfer",isErc20Ish:!0,isNFTIsh:!1,transferTo:d.args[0],amount:d.args[1]};let t=k(Bt,e);if(t)return{action:"transfer",functionName:"transferWithMemo",isErc20Ish:!0,isNFTIsh:!1,transferTo:t.args[0],amount:t.args[1]};if(!r)return{action:"transaction",functionName:"",isErc20Ish:!1,isNFTIsh:!1};let i=k(Ot,e);if(i&&typeof i.args[1]=="string"){let b=Wt(i.args[1]);if(b&&b[4].encodedInitData)return Ee(b[4].encodedInitData,r)}let y=k(Ut,e);if(y)return{action:"approve",functionName:"setApprovalForAll",isNFTIsh:!0,isErc20Ish:!1,operator:y.args[0],approved:y.args[1]};let g=k(Ht,e);if(g)return{action:"transfer",functionName:"transferFrom",isNFTIsh:!0,isErc20Ish:!1,transferFrom:g.args[0],transferTo:g.args[1],tokenId:g.args[2]};let x=k(Pt,e);if(x)return{action:"transfer",functionName:"safeTransferFrom",isNFTIsh:!0,isErc20Ish:!1,transferFrom:x.args[0],transferTo:x.args[1],tokenId:x.args[2]};let I=k(Vt,e);if(I)return{action:"transfer",functionName:"safeTransferFrom",isNFTIsh:!0,isErc20Ish:!1,transferFrom:I.args[0],transferTo:I.args[1],tokenId:I.args[2],amount:I.args[3]};let f=k(Lt,e);if(f)return{action:"batch transfer",functionName:"safeBatchTransferFrom",isNFTIsh:!0,isErc20Ish:!1,transferFrom:f.args[0],transferTo:f.args[1],tokenIds:f.args[2],amounts:f.args[3]};let l=k(qt,e);return l?{action:"mint",functionName:l.functionName,isNFTIsh:!0,isErc20Ish:!1,args:l.args}:{action:"transaction",isErc20Ish:!1,isNFTIsh:!1}};let k=(e,r)=>{try{let p=dt({abi:e,data:r});return{functionName:p.functionName,args:p.args||[]}}catch{return null}},Wt=e=>{try{if(typeof e=="string")return ct(Rt,`0x${e.slice(10)}`)}catch{return null}},z=e=>`${parseFloat(e).toFixed(2)}`;function Gt(e,r){let p=[],d=new Map;if(e){for(let t of e)if(t.in[0]){let i;i=t.asset.type==="ERC721"||t.in[0].value==="approve_for_all"?{id:`nft:${t.asset.name}`,nftName:t.asset.name,nftCount:t.in.length}:{id:`token:${t.asset.type}:${t.asset.symbol}:${t.asset.name}`,iconUrl:t.asset.logo_url,value:t.in[0].value,symbol:t.asset.symbol,usdValue:t.in[0].usd_price?z(t.in[0].usd_price):void 0,decimals:t.asset.decimals},p.push(i)}else if(t.out[0]?.value){let i;i=t.asset.type==="ERC721"||t.out[0].value==="approve_for_all"?{id:`nft:${t.asset.name}`,nftName:t.asset.name}:{id:`token:${t.asset.type}:${t.asset.symbol}:${t.asset.name}`,iconUrl:t.asset.logo_url,value:t.out[0].value,symbol:t.asset.symbol,usdValue:t.out[0].usd_price?z(t.out[0].usd_price):void 0,decimals:t.asset.decimals},d.has(i.id)||d.set(i.id,i)}}for(let t of r)for(let i of Object.keys(t.spenders)){let y;y=t.asset.type==="ERC721"||t.spenders[i]?.value==="approve_for_all"?{id:`nft:${t.asset.name}`,nftName:t.asset.name}:{id:`token:${t.asset.type}:${t.asset.symbol}:${t.asset.name}`,iconUrl:t.asset.logo_url,value:t.spenders[i]?.value,symbol:t.asset.symbol,usdValue:t.spenders[i]?.usd_price?z(t.spenders[i]?.usd_price):void 0,decimals:t.asset.decimals},d.has(y.id)||d.set(y.id,y)}return{assetsIn:p,assetsOut:Array.from(d.values())}}const Qt=(e,r,p,d)=>{let[t,i]=a.useState(null),{walletProxy:y}=J();return a.useEffect(()=>{t&&i(null),(async()=>{if(!y||!r)return null;let g=[],x=!0,I=await ut(e,p,r,d).catch(f=>(f.message&&f.message.includes("Insufficient balance for transaction")||f.message&&f.message.includes("Insufficient funds for gas * price + value")||f.details&&f.details.includes("insufficient funds")?x=!1:g.push(f),e));return{tx:I,totalGasEstimate:I.gas,hasFunds:x,errors:g}})().then(i)},[e]),t};let be=new he(new ge("There was an issue preparing your transaction",Ie.E32603_DEFAULT_INTERNAL_ERROR.eipCode)),Te=(e,r)=>e?.sendTransaction?"transactionRequest"in e.sendTransaction?e.sendTransaction.transactionRequest:e.sendTransaction.transactionRequests[r]:void 0;const Bn={component:()=>{let{data:e,onUserCloseViaDialogOrKeybindRef:r,setModalData:p,navigate:d}=Ze(),{client:t,rpcConfig:i,chains:y,closePrivyModal:g,walletProxy:x,showFiatPrices:I}=J(),{user:f}=et(),l=tt(),[b,X]=a.useState(0),[A,Me]=a.useState(0),[o,Y]=a.useState(Te(e,b)),[S,Se]=a.useState(null),[Z,ee]=a.useState(),[B,te]=a.useState(!1),[q,Fe]=a.useState(null),[ne,_e]=a.useState(null),[N,ae]=a.useState(null),[P,Ce]=a.useState(void 0),[Ne,U]=a.useState(void 0),[we,se]=a.useState(!1),[ie,re]=a.useState(!1),[$e,j]=a.useState([]),[Ae,je]=a.useState([]),[O,H]=a.useState("uninitiated"),[Oe,Re]=a.useState(void 0);if(!o||!e?.sendTransaction||!e?.sendTransaction)return s.jsx(gt,{error:Error("Invalid transaction request"),allowlistConfig:l.allowlistConfig,onRetry:()=>{e?.sendTransaction?.onFailure(be),g({shouldCallAuthOnSuccess:!1})}});let{transactingWalletAddress:w}=e.sendTransaction,v=a.useMemo(()=>y.find(n=>Number(n.id)===Number(o.chainId)),[o.chainId]),$=v?.nativeCurrency.symbol??"ETH",T=a.useMemo(()=>Ee(o.data,!!l.embeddedWallets.extendedCalldataDecoding),[o.data]),{action:E,isErc20Ish:C,isNFTIsh:De,functionName:R}=T,{toAddress:Be,tokenAddress:oe}=a.useMemo(()=>({toAddress:T.isErc20Ish?T.transferTo:o.to??void 0,tokenAddress:T.isErc20Ish?o.to:void 0}),[T]);a.useEffect(()=>{o.to&&v&&C&&bt({address:o.to,chain:v,rpcConfig:l.rpcConfig,privyAppId:l.id}).then(Se).catch(console.error)},[o.to,v]);let{tokenPrice:F,isTokenPriceLoading:qe}=yt(o.chainId),{balance:le}=ft({rpcConfig:l.rpcConfig,appId:l.id,address:w,chain:v}),ue=function({rpcConfig:n,appId:c,address:h,chain:m,tokenInfo:M}){let{chains:Je}=J(),[G,Xe]=a.useState(null),[Ye,ce]=a.useState(!1),Q=a.useMemo(()=>{let _=m||Je[0];if(_)return nt({chain:m,transport:at(st(_,n,c))})},[m,n,c]),me=a.useCallback(async()=>{if(h&&Q&&M.address)try{return ce(!0),await Q.readContract({address:M.address,abi:Ct,functionName:"balanceOf",args:[h]})}catch(_){console.error(_)}finally{ce(!1)}},[Q,h,M?.address,m]);return a.useEffect(()=>{me().then(_=>_!=null&&Xe(_))},[me]),{balance:G,isLoading:Ye&&G==null,formattedBalance:_t({amount:G??BigInt(0),decimals:M.decimals})}}({rpcConfig:l.rpcConfig,appId:l.id,address:w,tokenInfo:{address:oe||"",decimals:S?.decimals??18},chain:v}),pe=a.useMemo(()=>it(Number(o.chainId),y,i,{appId:l.id}),[o.chainId,i]),u=Qt(o,w,pe,e?.sendTransaction?.prepareTransactionRequest);a.useEffect(()=>{Y(Te(e,b))},[b]),a.useEffect(()=>{e.sendTransaction?.getIsSponsored?e.sendTransaction.getIsSponsored().then(ee).catch(console.error):ee(!1)},[e.sendTransaction.getIsSponsored]);let D=()=>{if(!B)return q?e?.sendTransaction?.onSuccess({hash:q}):N||u?.errors[0]?e?.sendTransaction?.onFailure(N??u?.errors[0]??be):e?.sendTransaction?.onFailure(new he(new ge("The user rejected the request",Ie.E4001_USER_REJECTED_REQUEST.eipCode))),g({shouldCallAuthOnSuccess:!1})};r.current=D;let L=!!(e.funding&&e.funding.supportedOptions.length>0),Pe=fe(BigInt(u?.totalGasEstimate??0n),$),Ue=I&&F?K(BigInt(u?.totalGasEstimate??0n),F):void 0,He=fe(le??0n,$,void 0,!0),Le=I&&F?K(le??0n,F):void 0,Ve=S&&!ue.isLoading&&C&&E!=="approve"?`${ue.formattedBalance} ${S.symbol}`:void 0,V=e.sendTransaction?.uiOptions?.transactionInfo?.title;V||(V=E==="approve"?C?"Confirm address":"Confirm action":`Approve ${E}`);let We=a.useMemo(()=>{if(e.sendTransaction?.uiOptions?.description)return e.sendTransaction?.uiOptions?.description;if(E==="approve"&&R==="setApprovalForAll"&&T.approved){let n=s.jsx(ye,{address:T.operator||"",url:v?.blockExplorers?.default?.url});return s.jsxs(s.Fragment,{children:[l.name," would like your permission for ",n," to transfer tokens on your behalf."]})}if(E==="approve"&&R==="setApprovalForAll"&&!T.approved){let n=s.jsx(ye,{address:T.operator||"",url:v?.blockExplorers?.default?.url});return s.jsxs(s.Fragment,{children:[l.name," would like your permission to revoke permissions of ",n," from transferring tokens on your behalf."]})}return C&&E==="approve"||C&&E==="approve"?`${l.name} would like your permission for ${rt(T.spender)} to spend tokens on your behalf.`:`${l.name} wants your permission to approve the following transaction.`},[l.name,C,T,e.sendTransaction?.uiOptions.description,R]),Ge=e.sendTransaction?.uiOptions?.transactionInfo?.contractInfo?.imgUrl?s.jsx("img",{src:e.sendTransaction.uiOptions.transactionInfo.contractInfo.imgUrl,alt:e.sendTransaction.uiOptions.transactionInfo.contractInfo.imgAltText}):null,W=!(!u||u.errors[0]||u.hasFunds||Z!==!1),de=W&&L,Qe=de?"Add funds":e.sendTransaction?.uiOptions?.buttonText||(b<A?"Continue":"Approve"),Ke=n=>{if(!n)throw Error("Transaction scan failed");if(n.validation.status==="Success"&&(n.validation.result_type==="Benign"?U("safe"):n.validation.result_type==="Warning"?U("warn"):n.validation.result_type==="Malicious"&&(U("error"),re(!0))),n.simulation.status!=="Success")throw Error("Simulation failed");{Ce(n.simulation.params);let{assetsIn:c,assetsOut:h}=Gt(n.simulation.assets_diffs,n.simulation.exposures);if(h.length===0&&c.length===0)throw Error("No tokens found");j(h),je(c)}};if(a.useEffect(()=>{e.sendTransaction?.scanTransaction&&l.embeddedWallets.transactionScanning.enabled&&O==="uninitiated"&&(H("in progress"),e.sendTransaction.scanTransaction().then(n=>{Ke(n),H("completed")}).catch(()=>H("failed")))},[!!e.sendTransaction?.scanTransaction]),a.useEffect(()=>{e.sendTransaction?.scanTransaction&&O!=="failed"||((n,c,h)=>{if(Me((m=>m?.sendTransaction?"transactionRequest"in m.sendTransaction?0:m.sendTransaction.transactionRequests.length-1:0)(e)),c.isErc20Ish&&c.amount&&h){let m=Tt({amount:c.amount,decimals:h.decimals});Re(m),j([{value:m,symbol:h?.symbol,decimals:h?.decimals}])}else if(n.value){let m=BigInt(n.value),M=F?K(m,F):void 0;j(I&&M?[{value:M}]:[{value:ht(m),symbol:$,decimals:18,usdValue:M}])}else j(I?[{value:"$0"}]:[{value:"0",symbol:$,decimals:18}])})(u?.tx??o,T,S)},[o,u?.tx,T,S,O]),ne)return s.jsx(At,{txn:u?.tx??o,onClose:D,receipt:ne,transactionInfo:e.sendTransaction?.uiOptions.transactionInfo,tokenPrice:F,tokenSymbol:$,receiptHeader:e.sendTransaction?.uiOptions.successHeader,receiptDescription:e.sendTransaction?.uiOptions.successDescription});if(N)return s.jsx(kt,{transactionError:N,transactionHash:q??void 0,chainType:"ethereum",chainId:u?.tx.chainId??o.chainId,onClose:D,onRetry:({resetNonce:n})=>{ae(null);let c={...u?.tx??o};n&&(c.nonce=void 0),Y(c)}});let ze=A!==0&&typeof b=="number"&&b!==0?()=>{X(b-1)}:void 0;return we&&P?s.jsx(wt,{details:P,onBack:()=>se(!1)}):s.jsx(xt,{transactionIndex:b,onBack:ze,maxIndex:A,disabled:W&&!L||ie,isSubmitting:B,submitError:N,isPreparing:!u,isTokenPriceLoading:qe,isTokenContractInfoLoading:!De&&!S,prepareError:u?.errors[0],symbol:S?.symbol,chain:v,img:Ge,title:V,subtitle:We,txValue:o.value,fee:Ue??Pe,isSponsored:Z,from:w??"",to:Be,tokenAddress:oe??void 0,network:l.chains.find(n=>n.id===o.chainId)?.name??"",transactionDetails:{...T,formattedAmount:Oe},cta:Qe,missingFunds:W,action:E,balance:Ve??Le??He,onClose:D,onClick:de?async()=>{if(!w)return;if(!L)throw Error("Funding wallet is not enabled");let n="FundingMethodSelectionScreen";p({...e,funding:{...e.funding,methodScreen:n,chainType:"ethereum",amount:ot(BigInt(u?.tx.value??0)+BigInt(u?.totalGasEstimate?.toString()??0)),chain:v},solanaFundingData:e?.solanaFundingData}),d(n)}:async()=>{if(b<A)X(b+1);else{te(!0);try{let n=await t.getAccessToken();if(B||!n||!x||!f)return;let c=await e.sendTransaction.onConfirm({transactionRequest:u?.tx??o});if(Fe(c),e.sendTransaction?.signOnly)return await new Promise(m=>setTimeout(m,lt)),e?.sendTransaction?.onSuccess({hash:c}),g({shouldCallAuthOnSuccess:!1});let h=await pe.waitForTransactionReceipt({hash:c});if(h.status==="reverted")throw Error("Transaction failed");_e(h)}catch(n){console.warn({transaction:u?.tx??o,error:n}),ae(n)}finally{te(!1)}}},validation:Ne,hasScanDetails:!!P,setIsScanDetailsOpen:se,preventMaliciousTransaction:ie,setPreventMaliciousTransaction:re,tokensSent:$e,tokensReceived:Ae,isScanning:O==="in progress",isCancellable:e.sendTransaction?.uiOptions?.isCancellable??!1,functionName:R})}};export{Bn as SendTransactionScreen,Bn as default};
