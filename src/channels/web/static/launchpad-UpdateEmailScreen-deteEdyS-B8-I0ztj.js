import{j as e,r as o}from"./launchpad.js";import{F as b}from"./launchpad-EnvelopeIcon-IX6JTo8v.js";import{e as v}from"./launchpad-Layouts-BlFm53ED-C7q8tWPJ.js";import{dy as A,d6 as C,d4 as U,dn as T,d5 as M,e1 as $,e2 as P}from"./launchpad-App-CJN8YHj9.js";import{V as R,m as q}from"./launchpad-ModalHeader-JjfRejxC-CtYe7KE2.js";import{t as D,e as I}from"./launchpad-EmailInputForm-Dgoii4vf-C3j96MW0.js";import{e as F}from"./launchpad-ErrorMessage-D8VaAP5m-BxUDDoNF.js";import{n as W}from"./launchpad-ScreenLayout-Ca6ml9wY-tWBwodfe.js";import{M as L}from"./launchpad-mail-C5wDGb2q.js";import"./launchpad-Screen-DE3ldE_X-Bg_Q5Z_h.js";import"./launchpad-index-Dq_xe9dz-DPq0PTtR.js";import"./launchpad-createLucideIcon-BSOjrqRH.js";const N=o.forwardRef((s,d)=>{let[a,S]=o.useState(""),[t,c]=o.useState(""),[l,u]=o.useState(!1),{authenticated:w,user:i}=A(),{initUpdateEmail:p}=C(),{navigate:n,setModalData:f,currentScreen:g}=U(),{enabled:j,token:h}=T(),k=M(),y=$(a)&&(k.disablePlusEmails&&a.includes("+")?(t||c("Please enter a valid email address without a '+'."),!1):(t&&c(""),!0)),x=l||!y,m=()=>{!j||h||w?(async r=>{if(!i?.email)throw Error("User is required to have an email address to update it.");u(!0);try{await p({oldAddress:i.email.address,newAddress:a,captchaToken:r}),n("AwaitingPasswordlessCodeScreen")}catch(E){f({errorModalData:{error:E,previousScreen:g||"LandingScreen"}}),n("ErrorScreen")}u(!1)})(h):(f({captchaModalData:{callback:r=>{if(!i?.email)throw Error("User is required to have an email address to update it.");return p({oldAddress:i.email.address,newAddress:a,captchaToken:r})},userIntentRequired:!1,onSuccessNavigateTo:"AwaitingPasswordlessCodeScreen",onErrorNavigateTo:"ErrorScreen"}}),n("CaptchaScreen"))};return e.jsxs(e.Fragment,{children:[e.jsxs(V,{children:[t&&e.jsx(F,{style:{marginTop:"0.25rem",textAlign:"left"},children:t}),e.jsxs(K,{$error:!!t,children:[e.jsx(P,{children:e.jsx(L,{})}),e.jsx("input",{ref:d,id:"email-input",type:"email",placeholder:"your@email.com",onChange:r=>S(r.target.value),onKeyUp:r=>{r.key==="Enter"&&m()},value:a,autoComplete:"email"}),s.stacked?null:e.jsx(R,{isSubmitting:l,onClick:m,disabled:x,children:"Submit"})]})]}),s.stacked?e.jsx(q,{loadingText:null,loading:l,disabled:x,onClick:m,style:{width:"100%"},children:"Submit"}):null]})});let V=D,K=I;const z=({title:s="Update your email",subtitle:d="Add the email address you'd like to use going forward. We'll send you a confirmation code"})=>e.jsx(W,{title:s,subtitle:d,icon:b,watermark:!0,children:e.jsx(v,{children:e.jsx(N,{stacked:!0})})}),ae={component:()=>e.jsx(z,{})};export{ae as UpdateEmailScreen,z as UpdateEmailScreenView,ae as default};
